using NUnit.Framework;
using System;
using PencilDurabilityKata.Kata;
namespace PencilDurabilityTests
{
    [TestFixture]
    public class PencilSharpenTests
    {
        private Pencil sut;

        private Paper paper;

        [SetUp]
        public void init()
        {
            paper = new Paper();
        }

        [Test]
        public void TestWhenPencilIsSharpenedItCanWriteAgainUpToItsInitialSharpen()
        {
            sut = new Pencil(3);
            sut.Write(paper, "foo");
            sut.Sharpen();
            sut.Write(paper, "bar");
            Assert.AreEqual("foobar", paper.Text);
        }

        [Test]
        public void TestWhenPencilIsInitializedWithNegativeLengthArgumentExceptionIsThrown()
        {
            Assert.Throws<ArgumentException>(() => sut = new Pencil(1, -1));
        }

        [Test]
        public void TestThatPencilCanOnlyBeSharpenedAsMuchAsItsLength()
        {
            sut = new Pencil(2, 1);
            sut.Write(paper, "fo");
            sut.Sharpen();
            sut.Write(paper, "ob");
            sut.Sharpen();
            sut.Write(paper, "ar");
            Assert.AreEqual("foob  ", paper.Text);
        }

        [Test]
        public void TestThatPencilSharpeningMultipleTimesDoesNotIncreaseItsDurabilityPastItsInitialValue()
        {
            sut = new Pencil(5, 5);
            sut.Sharpen();
            sut.Sharpen();
            sut.Sharpen();
            sut.Write(paper, "Foobar");
            Assert.AreEqual("Foob  ", paper.Text);
        }
    }
}
